<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "XHTML 1.0 Strict"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="Last-modified" content="Mon, 4 Apr 2011 12:00:00 GMT"/>
<title>Java Bioinformatics Analyses Web Services (JABAWS) Server Web Aplication aRchive manual</title>
<link href="ws.css" rel="stylesheet" type="text/css" media=
"screen, projection, handheld, tv" />
<link rel="stylesheet" type="text/css" media="print" href=
"print.css" />
<script type="text/javascript" src="prototype-1.6.0.3.js"></script>
</head>
<body>
<div id="page">
<div id="banner">
<table> 
<tr><td style="width:158px;"><a href="http://www.dundee.ac.uk"><img src="images/uod_lt_long.gif"  alt="University of Dundee" width="158" height="90" class="logo"  title="University of Dundee" longdesc="http://www.dundee.ac.uk"/></a></td>
<td class="bg"><img src="images/jabaws2.png" alt="JABAWS-2.0:Disorder" width="353" height="67" title="JABAWS-2.0:Disorder"/></td>
<td class="bg"><img src="images/banner_right.png" alt="Disorder" width="200" height="80"/></td>
</tr>
</table>
</div><!-- banner end-->

<div id="wrapper">
<div id="panel"><a href="index.html">Home</a> 
	 <a href="quick_start.html">Getting Started</a> 
    <a class="selected" href="man_about.html">Manual</a> 
	<div id="submenu">
		<a href="man_about.html">About</a>
		<a href="man_servervm.html" title="JABAWS Server as Virtual Appliance">Server VA</a>
		<a class="selected" href="man_serverwar.html" title="JABAWS Server as Web Application aRchive">Server WAR</a>
		<a href="man_configuration.html" >Server<br/>
		Configuration</a>
		<a href="man_client.html" title="JABAWS Command Line Client">CMD Client</a>
		<a href="man_stats.html" title="JABAWS Usage Statistics">Usage Statistics</a>
		<a href="man_dev.html" title="Accessing JABAWS from your program">Accessing<br/>
		JABAWS</a>	
	</div>
<a href="download.html">Download</a> 
<a href="contacts.html">Contact Us</a>
<a href="PublicAnnualStat" title="JABAWS server usage statistics">Usage Statistics</a>
<a href="http://www.compbio.dundee.ac.uk" title="University of Dundee, The Barton Group" >Barton Group</a></div>

<!-- panel end-->
<div id="content">
<h2 id="headtitle">JABAWS MANUAL</h2>

<h2>JABAWS Server Web Application aRchive (WAR) </h2>
<ul>
  <li><a href="#sysreq">System Requirements</a></li>
  <li><a href="#instwar">Installing the JABAWS WAR file</a></li>
  <li><a href="#prepexec">Preparing executables for use with JABAWS</a></li>
  <li><a href="#useprebin">Using the pre-compiled i386 binaries on Linux</a></li>
  <li><a href="#recompbinaries">Recompiling the bundled
    programs for your system</a></li>
  <li><a href="#haveexec">Reuse the binaries that are
    already in your system</a></li>
  <li><a href="#obtainexec">Obtaining alignment
    programs for your operating system</a></li>
  <li><a href="#usingWsTester">Testing JABAWS Server</a></li>
  <li><a href="#diffcontexts">Running many JABAWS instances on the same server</a> </li>
  <li><a href="#nocluster">JABAWS on a single server</a></li>
  <li><a href="#clustsubsys">JABAWS supported cluster batch management systems </a></li>
  <li><a href="#tomstopundeploy">Manually deploying JABAWS application on Apache-Tomcat </a></li>
</ul>
<p><strong>Troubleshooting</strong></p>
<ul>
  <li><a href="#tomdeploy">Apache-Tomcat fails to deploy the jabaws.war file</a></li>
  </ul>
<h3><a name="sysreq" id="sysreq"></a>System Requirements</h3>
<p>JABAWS requires a Java web application server compliant with
version 2.4 of the Java Servlet specification, and a Java 6 runtime
environment. We recommend using an official Oracle Java 6 runtime
environment, and <a
href="http://tomcat.apache.org/download-60.cgi">Apache-Tomcat</a> web application server version 6, but other versions may work as well.<br/><span class="attention">Please Note:</span> The JABAWS WAR is not generally compatible with older Mac systems based on the PowerPC architecture, since Java 1.6 is not available to run JABAWS.</p>

<p>JABAWS Web Application aRchive can run on any host operating system that supports Java 1.6. However JABAWS depends on a number of third party programs which are not available for all operating systems. In particular, only Clustal and Muscle are currently available for MS Windows platform.
  <!-- todo: link to help about obtaining and installing tomcat -->
</p>
<p>JABAWS comes with pre-compiled MS Windows and Linux IA32 binaries, as well as the source code and build scripts necessary to recompile them.</p>
<p>To run JABAWS on the cluster you must have shared disk space accessible from all cluster nodes. </p>
<h3><a name="instwar" id="instwar"></a>Installing the JABAWS WAR file</h3>
<p>JABAWS is distributed as a web application archive (WAR). To
deploy JABAWS in Apache-Tomcat - simply drop the war file into the
<span class="highlight">webapps</span> directory of a running
Tomcat, and it will do the rest. If you used this deployment procedure, <span class="attention">do not remove</span> the jabaws WAR file, otherwise Tomcat will undeploy your application! The context path for your deployed application will be the same as the name of the war file. For example, assuming the Tomcat server is running on the <span class="hightlight">localhost:8080</span> and <strong>jaba.war</strong> file is put into the <span class="hightlight">&lt;tomcat server root&gt;/webapps</span> directory, the deployed application from the jaba.war file then can be accessed by this URL http://localhost:8080/<strong>jaba</strong>. </p>
<p>For any other web application
  server, please follow your server's specific deployment procedure
  for 'WAR' files. If you install JABAWS on a MS Windows machine, then
  at this point your JABAWS installation will already be up and
  running, and you can try its services out <a href=
"#usingWsTester">as described here</a>. If you install JABAWS on Linux you will need to set an executable flag for binaries. This is described  <a href="#useprebin">here</a>. If your host operating system is different from Windows or Linux then read on. </p>
<h3><a name="prepexec" id="prepexec"></a>Preparing executables for use with JABAWS</h3>

<p>JABAWS's web services use command line programs to do
the actual analysis, so it must have access to programs
which can be executed on your platform. The native executables
bundled with JABAWS for Windows (32-bit) and Linux (i386, 32-bit) should be
OK for those systems. The source code for these 
programs is also provided so you can <a href="#recompbinaries">recompile for your own
architecture</a> and exploit any optimizations that your system can
provide. Alternately, if you have already got binaries on your
system, then you can simply <a href="#haveexec">change the paths in JABAWS's
configuration files</a> so these are used instead.</p>

<h3><a name="useprebin" id="useprebin"></a>Using the pre-compiled i386 binaries on Linux</h3>

<p>Before the binaries that are bundled with JABAWS can be used,
they must first be made executable using the provided <a name=
"setexecflag" id="setexecflag">'setexecflag.sh'</a> script:</p>

<ol>
<li>cd to <span class=
"hightlight">&lt;webapplicationpath&gt;/binaries/src</span></li>

<li>run <span class="hightlight">sh setexecflag.sh</span></li>

<li>Make sure binaries supplied work under your OS.<br />
 For this run each binary, without any command line options or
input files. If you see an error message complaining about missing
libraries or other problems, then you probably need to <a href=
"#recompbinaries">recompile the binaries</a>.</li>

<li>Restart the Tomcat.</li>
</ol>

That's it! JABAWS should work at this point. Try it out using the JABAWS<a
href="#usingWsTester"> test client</a>. If not,
read on... or have a look at <a href="http://tomcat.apache.org/tomcat-6.0-doc/deployer-howto.html">deploying on Tomcat</a> tips.<br />
 <em>Note: You may want to enable logging, <a href="man_configuration.html#logfiles"> as described here</a></em>.<br />
 

<h3><a name="recompbinaries">Recompiling the bundled
programs for your system</a></h3>

<p>If you have a fully equipped build environment on your
(POSIX-like) system, then you should be able to recompile the
programs from the source distributions which are included
in the JABAWS war file. A script called 'compilebin.sh' is provided
to automate this task.</p>

<ol>
<li>In a terminal window, change the working directory to <span
class="hightlight">binaries/src</span></li>

<li>execute the <span class="highlight">compilebin.sh</span>
script,<br />
 either use: <span class="hightlight">chmod +x compilebin.sh;
compilebin.sh &gt; compilebin.out;</span><br />
 or: <span class="hightlight">sh compilebin.sh &gt;
compilebin.out</span></li>

<li>Now run <span class="hightlight">sh setexecflag.sh</span><br />
 If any of the binaries was not recompiled, then a 'file not found'
error will be raised.</li>

<li>Finally, restart your Tomcat server (or JABAWS application only), and <a href="#usingWsTester">test JABAWS</a> to
check that it can use the new binaries.</li>
</ol>

<p>If you couldn't compile everything, then it may be that your system does
not have all the tools required for compiling the programs. At the very
least check that you have gcc, g++ and make installed in your
system. If not install these packages and repeat the compilation
steps again. You should also review the compilebin.sh output -
which was redirected to compilebin.out, and any errors output to
the terminal. Finally, try obtaining the <a href="#obtainexec">pre
compiled binaries</a> for your OS.</p>

<h3><a name="haveexec" id="haveexec">Reuse the binaries that are
already in your system</a></h3>

<p>If you would like to use the binaries you already have then you
just need to let JABAWS know there they are. To do this, edit:
<span class="code">conf/Executable.properties</span></p>
<p>When specifying paths to executables that already exist on your system, make sure you provide an absolute path, or one relative to the JABAWS directory inside <span class="highlight">webapps</span>. For example, the default path for clustalw is defined
as<span class=
"code">local.clustalw.bin=binaries/src/clustalw/src/clustalw2</span>
Alternatively, instead of changing <span class=
"hightlight">Executable.properties</span> you could also replace
the executables bundled with JABAWS with the ones that you have, or make symbolic links to them.
Then the default configuration will work for you. More information
about <span class="hightlight">the
Executable.properties</span> file is given in the <a href="man_configuration.html#exec">JABAWS Configuration chapter.</a></p>

<h3><a name="obtainexec" id="obtainexec">Obtaining alignment
programs for your operating system</a></h3>

<p>You could search for pre-packaged compiled executable in your
system package repository or alternately, download pre-compiled
binaries from each alignment program's home page. Then, either
replace the executables supplied with the downloaded ones, or
modify the paths in <span class=
"hightlight">executable.properties</span> as described above. Below are some suggestions on where you may be able to get the binaries for your system. </p>
<ul>
  <li><a href="ftp://ftp.ebi.ac.uk/pub/software/clustalw2/2.0.12/">ClustalW</a></li>
  <li><a href="http://mafft.cbrc.jp/alignment/software/">Mafft</a></li>
  <li><a href="http://www.drive5.com/muscle/download3.6.html">Muscle</a></li>
  <li><a href="http://www.tcoffee.org/Packages/Binaries/">Tcoffee</a></li>
  <li>Probcons (Linux <a href="http://www.compbio.dundee.ac.uk/jabaws/archive/binaries/linux_x86/probcons">x86</a> | <a href="http://www.compbio.dundee.ac.uk/jabaws/archive/binaries/linux_x64/probcons">x64</a>)</li>
</ul>
<h3><a name="usingWsTester" id="usingWsTester"></a>Testing JABAWS Server </h3>
<p>First of all make sure that Tomcat server is started successfully. If this was the case, then you should see JABAWS home page when you navigate to your Tomcat JABAWS context path e.g. <span class="code">http://myhost.compbio.ac.uk:8080/jabaws</span>If you see it, then it is time to make sure that web services are working too. Assuming that you have unpacked/deployed JABAWS from the server war file, you should be able to navigate to the test program which can be found in &lt;webapplicationpath&gt;/WEB-INF/lib/jabaws-client.jar file. To run the tests type:<span class="code"> java -jar jabaws-client.jar -h=&lt;Your web application server host name, port and JABAWS context path&gt;</span></p>
<p>For example to test all JABAWS web services on host myhost.compbio.ac.uk type: </p>
<p class="code">java -jar jabaws-client.jar -h=http://myhost.compbio.ac.uk:8080/jabaws </p>
<p>You can choose a particular web server using -s option like this <span class="code">java -jar jabaws-client.jar -h=http://myhost.compbio.ac.uk:8080/jabaws -s=ClustalWS </span>This command line assumes that java executable is in your path and jabaws-client.jar is located in the current directory.</p>
<p>An example of the report testing tool produces for operating web service looks like this: </p>
<p><span class="code"> Connecting to service MuscleWS on http://myhost.compbio.ac.uk:8080/jabaws ... OK<br />
  Testing alignment with default parameters:<br />
  Queering job status...OK<br />
  Retrieving results...OK<br />
  Testing alignment with presets:<br />
  Aligning with preset 'Protein alignment(Fastest speed)'... OK<br />
  Aligning with preset 'Nucleotide alignment(Fastest speed)'... OK<br />
  Aligning with preset 'Huge alignments (speed-oriented)'... OK<br />
  Queering presets...OK<br />
  Queering Parameters...OK<br />
  Queering Limits...OK<br />
  Queering Local Engine Limits...OK<br />
  Check is completed service MuscleWS IS WORKING</span>An example of the response of a web service which is deployed but is not operating is below: </p>
<p><span class="code">Connecting to service ProbconsWS on http://localhost:8080/ws ... OK<br />
  Testing alignment with default parameters:FAILED<br />
  Service ProbconsWS IS NOT FUNCTIONAL</span>If the web server did not respond the message looks like following: <span class="code">Connecting to service TcoffeeWS on http://localhost:8080/ws ... FAILED</span></p>
<h3><a name="diffcontexts" id="diffcontexts"/></a></a>Running many JABAWS instances on the same server</h3>
<p> JABAWS is supplied as a Web Application aRchive which can be dealt with as any other web applications. So it is perfectly possible to run two JABAWS instances from the same server. Just make two different contexts on your application server and unpack JABAWS in both of them. For example if your server name is http://www.align.ac.uk, and the context names are public and private. Than one group of users could be given a URL http://www.align.ac.uk/public and another http://www.align.ac.uk/private. These contexts will be served by two independent JABAWS instances, and could be configured differently. If you keep local engine enabled, make sure you reduce the number of threads local engine is allowed to use to avoid overloading the server. Alternatively two completely separate web application server instances (e.g. Apache-Tomcat) could be used. This will give you a better resilience and more flexibility in memory settings. </p>
<h3><a name="nocluster" id="nocluster"></a>JABAWS on a single server</h3>
<p>You can run  JABAWS on a single server. Obviously the capacity will be limited, but may be sufficient for a small lab. Installed on a single server, JABAWS executes tasks in parallel, so the more cores the server has the more requests it will be able to handle. </p>
<h3><a name="clustsubsys" id="clustsubsys"></a>JABAWS supported cluster batch management systems </h3>
<p>JABAWS uses <a href="http://drmaa.org/">DRMAA</a> v. 1.0 library to send and manage jobs on the cluster. DRMAA supports many different cluster job management systems. Namely Sun Grid Engine, Condor, PBS, GridWay, Globus 2/4, PBSPro, LSF. For up to date information please consult DRMAA web site. We found that DRMAA implementation differ from platform to platform and were trying to use only the basic functions. We have only tested JABAWS on Sun Grid Engine v 6.2. Please let use know if you have any experience of running JABAWS on other platforms.</p>
<h3><a name="tomstopundeploy" id="tomstopundeploy"></a>Manually deploying JABAWS application on Apache-Tomcat </h3>
<p>To stop Tomcat from automatically undeploying your application if the war file is removed use an explicit application descriptor. It could come in different flavors, the one I prefer if to drop a context descriptor file into <span class="hightlight">&lt;tomcatRoot&gt;conf/Catalina/localhost</span> directory. Name your context file the same as your application folder e.g. if you JABAWS resides in webappl/jabaws folder, then call the context file jabaws.xml. Below is an example of content this file might have.</p>
<p class="code">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />
  &lt;Context antiResourceLocking=&quot;false&quot; privileged=&quot;true&quot;  /&gt;</p>
<p>This should be sufficient to prevent Tomcat from removing your JABAWS from WEBAPPS. For more information about the Tomcat deployer <a href="http://tomcat.apache.org/tomcat-6.0-doc/deployer-howto.html">read this documentation on the Apache-Tomcat web site</a>.</p>
<h3><a name="tomdeploy" id="tomdeploy"></a>Apache-Tomcat fails to deploy jabaws.war file </h3>
<ul>
  <li>Make sure Tomcat have sufficient access rights to read your war file. </li>
  <li>Restart the Tomcat, sometimes it will not since that the new war file is added without restart</li>
  <li>If Tomcat still refuses to unpack the war file, unpack it manually into web application folder (the war file is just a zip archive). Restart the Tomcat.</li>
</ul>
</div>

<!-- content end-->
<div id="copyright">Last update: 1 April 2011<br />
 Peter Troshin, Jim Procter and Geoff Barton, The Barton Group, University of
Dundee, UK</div>
</div>

<!-- wrapper end-->
</div>
<!-- page end-->

<!-- Google analitics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try{
var pageTracker = _gat._getTracker("UA-5356328-1");
pageTracker._trackPageview();
} catch(err) {}
</script>
</body>
</html>

